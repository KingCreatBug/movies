import{r as g,w as ie,u as re,b as oe,c as ce,I as le,d as P,i as S,s as ue,e as de,U as T,g as G,h as pe,f as he,j as p,B as ge,t as K}from"./index-Crp3k3UN.js";import{M as fe,a as me}from"./MovieCard-CYPTIwTZ.js";function be(e="",t=1e3){const[h,o]=g.useState(e);return g.useEffect(()=>{const d=setTimeout(()=>{o(e)},t);return()=>{clearTimeout(d)}},[t,e]),h}const xe=()=>{},ve=xe(),k=Object,X=e=>e===ve,ye=e=>typeof e=="function",M=new WeakMap,$=(e,t)=>k.prototype.toString.call(e)===`[object ${t}]`;let Se=0;const B=e=>{const t=typeof e,h=$(e,"Date"),o=$(e,"RegExp"),d=$(e,"Object");let s,n;if(k(e)===e&&!h&&!o){if(s=M.get(e),s)return s;if(s=++Se+"~",M.set(e,s),Array.isArray(e)){for(s="@",n=0;n<e.length;n++)s+=B(e[n])+",";M.set(e,s)}if(d){s="#";const j=k.keys(e).sort();for(;!X(n=j.pop());)X(e[n])||(s+=n+":"+B(e[n])+",");M.set(e,s)}}else s=h?e.toJSON():t=="symbol"?e.toString():t=="string"?JSON.stringify(e):""+e;return s},Re=e=>{if(ye(e))try{e=e()}catch{e=""}const t=e;return e=typeof e=="string"?e:(Array.isArray(e)?e.length:e)?B(e):"",[e,t]},we=e=>Re(e?e(0,null):null)[0],V=Promise.resolve(),Pe=e=>(t,h,o)=>{const d=g.useRef(!1),{cache:s,initialSize:n=1,revalidateAll:j=!1,persistSize:A=!1,revalidateFirstPage:N=!0,revalidateOnMount:I=!1,parallel:E=!1}=o,[,,,v]=oe.get(ce);let a;try{a=we(t),a&&(a=le+a)}catch{}const[b,c,O]=P(s,a),q=g.useCallback(()=>S(b()._l)?n:b()._l,[s,a,n]);ue.useSyncExternalStore(g.useCallback(r=>a?O(a,()=>{r()}):()=>{},[s,a]),q,q);const R=g.useCallback(()=>{const r=b()._l;return S(r)?n:r},[a,n]),H=g.useRef(R());de(()=>{if(!d.current){d.current=!0;return}a&&c({_l:A?H.current:R()})},[a,s]);const Q=I&&!d.current,w=e(a,async r=>{const y=b()._i,l=b()._r;c({_r:T});const f=[],F=R(),[_]=P(s,r),x=_().data,D=[];let z=null;for(let u=0;u<F;++u){const[C,L]=G(t(u,E?null:z));if(!C)break;const[te,se]=P(s,C);let m=te().data;const ne=j||y||S(m)||N&&!u&&!S(x)||Q||x&&!S(x[u])&&!o.compare(x[u],m);if(h&&(typeof l=="function"?l(m,L):ne)){const J=async()=>{if(!(C in v))m=await h(L);else{const ae=v[C];delete v[C],m=await ae}se({data:m,_k:L}),f[u]=m};E?D.push(J):await J()}else f[u]=m;E||(z=m)}return E&&await Promise.all(D.map(u=>u())),c({_i:T}),f},o),U=g.useCallback(function(r,y){const l=typeof y=="boolean"?{revalidate:y}:y||{},f=l.revalidate!==!1;return a?(f&&(S(r)?c({_i:!0,_r:l.revalidate}):c({_i:!1,_r:l.revalidate})),arguments.length?w.mutate(r,{...l,revalidate:f}):w.mutate()):V},[a,s]),ee=g.useCallback(r=>{if(!a)return V;const[,y]=P(s,a);let l;if(pe(r)?l=r(R()):typeof r=="number"&&(l=r),typeof l!="number")return V;y({_l:l}),H.current=l;const f=[],[F]=P(s,a);let _=null;for(let x=0;x<l;++x){const[D]=G(t(x,_)),[z]=P(s,D),u=D?z().data:T;if(S(u))return U(F().data);f.push(u),_=u}return U(f)},[a,s,U,R]);return{size:R(),setSize:ee,mutate:U,get data(){return w.data},get error(){return w.error},get isValidating(){return w.isValidating},get isLoading(){return w.isLoading}}},je=ie(re,Pe),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function Ee(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}let W;const De=new Uint8Array(16);function Ce(){if(!W){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");W=crypto.getRandomValues.bind(crypto)}return W(De)}const Ne=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Y={randomUUID:Ne};function Ie(e,t,h){var d;if(Y.randomUUID&&!e)return Y.randomUUID();e=e||{};const o=e.random??((d=e.rng)==null?void 0:d.call(e))??Ce();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Ee(o)}const Z=20,Me=()=>{var a,b;const[e,t]=g.useState(""),[h,o]=g.useState(1),d=be(e,500),s=d?K.getMovieSearch(d,h):K.getMovieList("popular",h),{data:n,size:j,setSize:A,isLoading:N}=je(c=>s.replace("page=1",`page=${c+1}`),he),I=n?n.reduce((c,O)=>c.concat(O.results),[]):[],v=((a=n==null?void 0:n[0])==null?void 0:a.results.length)===0||n&&((b=n[n.length-1])==null?void 0:b.results.length)<Z;return p.jsxs("div",{className:"py-10 page-container",children:[p.jsxs("div",{className:"flex mb-10",children:[p.jsx("div",{className:"flex-1",children:p.jsx("input",{onChange:c=>t(c.target.value),type:"text",className:"w-full p-4 text-white outline-none bg-slate-800",placeholder:"Type here to search..."})}),p.jsx("button",{className:"p-4 text-white bg-primary",children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]}),N&&p.jsx("div",{className:"grid grid-cols-4 gap-10",children:new Array(Z).fill(0).map(()=>p.jsx(fe,{},Ie()))}),p.jsx("div",{className:"grid grid-cols-4 gap-10",children:!N&&I.length>0&&I.map(c=>p.jsx(me,{movie:c},c.id))}),p.jsx("div",{className:"mt-10 text-center",children:p.jsx(ge,{onClick:()=>v?{}:A(j+1),disabled:v,className:`${v?"bg-slate-300":""}`,children:"Load more"})})]})};export{Me as default};
